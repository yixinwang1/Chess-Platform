# 棋类对战平台 - Chess Battle Platform

## 📖 项目简介
一个基于Java面向对象设计的棋类对战平台，支持五子棋、围棋和黑白棋的对战功能。项目采用多种设计模式，实现了高扩展性、低耦合的架构设计，并新增用户账户管理、AI对战、录像回放等功能。

## 🎮 功能特性

### 核心功能（第一阶段）
✅ **双人对战**：支持五子棋和围棋的双人本地对战  
✅ **完整规则**：实现五子棋连五获胜、围棋提子和胜负判断  
✅ **游戏控制**：开始/重新开始游戏、悔棋、认输  
✅ **存档管理**：游戏状态保存与加载  
✅ **界面交互**：美观的控制台界面，实时棋盘显示  

### 新增功能（第二阶段）
🎯 **黑白棋对战**：完整实现黑白棋（Reversi）游戏规则  
👤 **用户账户系统**：用户注册、登录、战绩统计、排行榜  
🤖 **AI智能对战**：三个级别AI（简单/中级/高级），支持人机对战  
📹 **录像回放系统**：完整记录对局过程，支持回放和导出  
📊 **实时战绩系统**：自动更新用户战绩，关联游戏录像  

### 规则实现
- **五子棋**：连五获胜、棋盘满平局
- **围棋**：提子、虚着、劫争、数子法胜负判断
- **黑白棋**：合法落子、棋子翻转、无棋可走跳过
- **通用**：合法落子检查、禁入点判断

## 🏗️ 系统架构

### 设计模式应用
**第一阶段设计模式**：
- 策略模式：不同棋类游戏规则
- 命令模式：用户操作封装
- 观察者模式：界面与逻辑解耦
- 备忘录模式：悔棋和存档功能
- 工厂模式：游戏对象创建
- 单例模式：平台实例管理

**第二阶段新增设计模式**：
- 策略模式：多级别AI算法选择
- 工厂模式：AI对象动态创建
- 观察者模式：事件驱动的战绩更新和录像记录
- 状态模式：游戏回放状态管理
- 组合模式：用户系统统一抽象
- 适配器模式：数据接口适配

### 项目结构（更新）
```
src/
├── com/chessplatform/
│   ├── ChessPlatform.java          # 程序入口
│   ├── core/                       # 核心接口
│   ├── games/                      # 游戏实现
│   ├── model/                      # 数据模型
│   ├── command/                    # 命令模式
│   ├── memento/                    # 备忘录模式
│   ├── ui/                         # 用户界面
│   ├── auth/                       # 新增：用户认证管理
│   ├── ai/                         # 新增：AI系统
│   ├── stats/                      # 新增：战绩统计
│   ├── record/                     # 新增：录像回放
│   └── util/                       # 工具类
```

### 新增模块说明
- **auth/**：用户账户管理，包含用户注册、登录、密码加密、会话管理
- **ai/**：AI智能系统，实现三个级别的AI算法
- **stats/**：战绩统计系统，自动更新用户胜负记录
- **record/**：录像回放系统，支持游戏过程记录和回放

## 🚀 快速开始

### 编译运行
```bash
# 1. 克隆项目
git clone <repository-url>
cd chess-platform

# 2. 编译项目
javac -d ./bin ./src/com/chessplatform/**/*.java

# 3. 运行程序
java -cp ./bin com.chessplatform.ChessPlatform
```

### 配置文件
首次运行会自动创建以下目录：
- `data/` - 用户数据存储
- `records/` - 游戏录像存储
- `saves/` - 游戏存档存储

## 🎯 使用说明

### 启动与登录
程序启动后，首先进入用户账户管理界面：
```
╔════════════════════════════════════════════════════════╗
║                    用户账户管理                        ║
╠════════════════════════════════════════════════════════╣
║  1. 登录                                              ║
║  2. 注册                                              ║
║  3. 游客继续                                          ║
║  4. 查看排行榜                                        ║
║  5. 退出                                              ║
╚════════════════════════════════════════════════════════╝
请选择(1-5):
```

### 常用命令
```bash
╔════════════════════════════════════════════════════════╗
║                    可用命令列表                        ║
╠════════════════════════════════════════════════════════╣
║ 用户管理:                                              ║
║   login [user] [pass]  - 登录账户                      ║
║   logout               - 登出账户                      ║
║   register [u] [p] [cp]- 注册新账户                    ║
║   profile [username]   - 查看用户资料                  ║
║   records [username]   - 查看用户录像                  ║
║   leaderboard          - 查看排行榜                    ║
║                                                        ║
║ 游戏控制:                                              ║
║   start [game] [size] [mode] [blackAI] [whiteAI]       ║
║     game: gomoku, go, reversi                          ║
║     mode: pvp(玩家对战), pva(人机对战), ava(AI对战)    ║
║     AI: none, random, rule, mcts                       ║
║     示例: start gomoku 15 pva random none              ║
║   restart              - 重新开始                       ║
║ 游戏操作:                                              ║
║   move [row] [col]     - 在指定位置落子                ║
║   pass                 - 虚着(仅围棋)                  ║
║   undo                 - 悔棋                          ║
║   resign               - 认输                          ║
║   restart              - 重新开始当前游戏              ║
║   status               - 显示游戏状态                  ║
║                                                        ║
║ 存档管理:                                              ║
║   save [filename]      - 保存游戏                      ║
║   load [filename]      - 加载游戏                      ║
║   list                 - 列出所有存档                  ║
║                                                        ║
║ 系统设置:                                              ║
║   stats [on|off]       - 开启/关闭战绩统计            ║
║   record [on|off]      - 开启/关闭自动保存录像        ║
║   config               - 查看系统配置                ║
║   help                 - 显示帮助                     ║
║   hidehelp             - 隐藏帮助                     ║
║   exit                 - 退出程序                     ║
╚════════════════════════════════════════════════════════╝
```

### 示例游戏

#### 1. 用户对战
```bash
# 注册并登录
平台> register alice 123456 123456
平台> login alice 123456

# 开始黑白棋对战
alice> start reversi 8
请输入对手用户名(输入 'ai' 对战AI，'guest' 对战游客): bob

# 对局过程
黑方(alice)> move 3 2
白方(bob)> move 2 2
...
游戏结束! 白方(bob)获胜
alice的战绩已更新: 1战 0胜 1负 0平 (0.0%)
```

#### 2. AI对战演示
```bash
# 与简单AI对战
平台> start reversi 8 ai easy

# AI对战测试
平台> ai battle reversi 8 easy medium
AI对战: 简单AI vs 中级AI
统计结果: 中级AI胜率 92%
```

#### 3. 录像回放
```bash
# 保存并回放游戏
平台> save my_game
平台> load my_game
平台> playback
进入回放模式
录像信息: alice vs bob - 黑白棋 - 2024-01-15 14:30
回放> next
第1步: alice 落子于 (3,2) [思考: 2.3秒]
回放> speed 2x
回放速度调整为2倍速
```

#### 4. 查看战绩
```bash
平台> profile alice
用户档案:
用户名: alice
身份: 注册用户
战绩: 25战 18胜 5负 2平 (72.0%)
胜率: 72.0%

平台> leaderboard
=== 玩家排行榜 ===
排名  用户名        战绩        胜率
1     chess_master  50/60       83.3%
2     alice         18/25       72.0%
3     bob           15/22       68.2%
```

## 🔧 AI系统说明

### AI级别说明
1. **一级AI（简单）**：随机选择合法走法
2. **二级AI（中级）**：基于规则评分函数，优先选择优势位置
3. **三级AI（高级）**：蒙特卡洛树搜索算法，智能决策

### 黑白棋AI策略
- **角点策略**：优先占据四个角点
- **边线策略**：次优选择边线位置
- **控制策略**：尽量减少对手可走位置
- **终局策略**：终局阶段最大化棋子数量

## 📊 战绩系统

### 统计内容
- 总对局数、胜场、负场、平局数
- 胜率计算（精确到小数点后一位）
- 与不同对手的交战记录
- 各棋类游戏的专项目统计

### 数据持久化
- 用户数据自动保存到 `data/users.dat`
- 游戏录像按用户分类存储
- 支持数据备份和恢复

## 📹 录像系统

### 记录内容
- 每一步走法的完整信息（坐标、时间、思考时长）
- 游戏初始和最终状态
- 玩家信息和对局元数据
- 关键局面的快照

### 回放功能
- 逐帧播放/暂停
- 前进/后退控制
- 跳转到指定步数